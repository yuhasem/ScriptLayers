<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <?!= include("script") ?>
  </head>
  <body>
    <?!= include("style") ?>
    <p>
    <? if (!configWasFound) { ?>
      We couldn't find a configuration table in the document.  If this is expected (i.e. this is the first time you've run the script on this document) simply fill in some values below, press Generate, and we'll create one for next time.
    <? } else { ?>
      We found a configuration for this document!  Verify the settings below and then press Update to reparse the document.
    <? } ?>
    </p>
    <div>Generate Gif Sheet? <input type=checkbox id="generate-gif-sheet" name="generate-gif-sheet" label="Generate Gif Sheet" <? if (config["generate-gif-sheet"] == "true") { ?>checked <?}?>/></div>
    <div>Gif Sheet Generation Style (How should the script be broken up into portions to add gifs to?)
      <select id="gif-sheet-generation-style" name="style">
        <option value="clauses" <? if (config["gif-sheet-generation-style"] == "clauses") { ?>selected<? } ?>>Clauses</option>
        <option value="sentences" <? if (config["gif-sheet-generation-style"] == "sentences") { ?>selected<? } ?>>Sentences</option>
      </select>
    </div>
    <br>
    <? if (config["gif-sheet-link"]) { ?>
      <div>Gif Sheet (This was generated by a previous run of the script.  You probably don't want to change this.): <input type=text id="gif-sheet-link" value=<?= config["gif-sheet-link"] ?> /></div><br>
    <? } ?>
    <div>Script Start Keyword: <input type=text id="script-start-keyword" name="start-keyword" value=<?= config["script-start-keyword"] ?> /></div>
    <div>Script End Keyword: <input type=text id="script-end-keyword" name="end-keyword" value=<?= config["script-end-keyword"] ?> /></div>
    <br>
    <div>Strip all text contained in square brackets ([])? <input type=checkbox id="parser-strip-text-between-square-brackets" <? if (config["parser-strip-text-between-square-brackets"] == "true") { ?>checked <?}?>/></div>
    <div>Strip all text contained in curly braces ({})? <input type=checkbox id="parser-strip-text-between-curly-braces" <? if (config["parser-strip-text-between-curly-braces"] == "true") { ?>checked <?}?>/></div>
    <div>Strip all text contained in angle brackets (<>)? <input type=checkbox id="parser-strip-text-between-angle-brackets" <? if (config["parser-strip-text-between-angle-brackets"] == "true") { ?>checked <?}?>/></div>
    <br>
    <div>
      <input type=button value=<? if (configWasFound) { ?>"Update"<? } else { ?>"Generate"<? } ?> onclick="prepareConfig()" />
      <input type=button value="Close" onclick="google.script.host.close()" />
    </div>
    <p id="result"></p>
  </body>
</html>


